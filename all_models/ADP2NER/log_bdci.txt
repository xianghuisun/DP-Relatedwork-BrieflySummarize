2022-01-12 20:28:51,073 - main - INFO - <module> - 52 : Using device cuda
2022-01-12 20:28:51,121 - main - INFO - main - 193 : train sentences num : 5424
2022-01-12 20:28:51,121 - main - INFO - main - 194 : test sentences num : 940
2022-01-12 20:28:51,121 - main - INFO - main - 195 : Logging some examples...
2022-01-12 20:28:51,121 - main - INFO - main - 201 : Exon  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : -  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : specific  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : primers  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : developed  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : in  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : this  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : study  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : will  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : facilitate  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : mutation  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : screening  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : studies  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : of  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : patients  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : with  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : the  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : disease  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : .  O
2022-01-12 20:28:51,121 - main - INFO - main - 202 : --------------------------------------------------
2022-01-12 20:28:51,121 - main - INFO - main - 201 : 4  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : %  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : and  O
2022-01-12 20:28:51,121 - main - INFO - main - 201 : 10  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : .  O
2022-01-12 20:28:51,122 - main - INFO - main - 202 : --------------------------------------------------
2022-01-12 20:28:51,122 - main - INFO - main - 201 : Three  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : of  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : 13  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : uninformative  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : patients  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : had  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : constitutional  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : deletions  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : .  O
2022-01-12 20:28:51,122 - main - INFO - main - 202 : --------------------------------------------------
2022-01-12 20:28:51,122 - main - INFO - main - 201 : Identification  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : of  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : a  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : novel  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : mutation  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : of  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : the  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : CPO  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : gene  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : in  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : a  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : Japanese  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : hereditary  B-Disease
2022-01-12 20:28:51,122 - main - INFO - main - 201 : coproporphyria  I-Disease
2022-01-12 20:28:51,122 - main - INFO - main - 201 : family  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : .  O
2022-01-12 20:28:51,122 - main - INFO - main - 202 : --------------------------------------------------
2022-01-12 20:28:51,122 - main - INFO - main - 201 : We  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : have  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : established  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : the  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : genomic  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : organization  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : of  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : UBE3A  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : and  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : the  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : sequence  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : of  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : intron  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : -  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : exon  O
2022-01-12 20:28:51,122 - main - INFO - main - 201 : borders  O
2022-01-12 20:28:51,123 - main - INFO - main - 201 : .  O
2022-01-12 20:28:51,123 - main - INFO - main - 202 : --------------------------------------------------
2022-01-12 20:28:51,127 - main - INFO - main - 212 : Tag scheme : B-Disease I-Disease
2022-01-12 20:28:51,127 - main - INFO - main - 213 : Tag has been saved in /home/xhsun/Desktop/tmpFiles/pcode/WNUT-17-crf/pytorch_model.bin/label.json
2022-01-12 20:28:51,142 - main - INFO - main - 243 : model_name_or_path:/home/xhsun/NLP/huggingfaceModels/English/bert-base-uncased
2022-01-12 20:28:51,143 - main - INFO - main - 243 : file_path:/home/xhsun/Desktop/gitRepositories/ADP2NER/data/NCBI
2022-01-12 20:28:51,143 - main - INFO - main - 243 : save_dir:/home/xhsun/Desktop/tmpFiles/pcode/WNUT-17-crf/pytorch_model.bin
2022-01-12 20:28:51,143 - main - INFO - main - 243 : ckpt:None
2022-01-12 20:28:51,143 - main - INFO - main - 243 : learning_rate:3e-05
2022-01-12 20:28:51,143 - main - INFO - main - 243 : weight_decay:1e-05
2022-01-12 20:28:51,143 - main - INFO - main - 243 : epochs:10
2022-01-12 20:28:51,143 - main - INFO - main - 243 : train_batch_size:32
2022-01-12 20:28:51,143 - main - INFO - main - 243 : lstm_hidden_size:150
2022-01-12 20:28:51,143 - main - INFO - main - 243 : test_batch_size:64
2022-01-12 20:28:51,143 - main - INFO - main - 243 : max_grad_norm:1
2022-01-12 20:28:51,143 - main - INFO - main - 243 : warmup_proportion:0.1
2022-01-12 20:28:51,143 - main - INFO - main - 243 : max_len:196
2022-01-12 20:28:51,143 - main - INFO - main - 243 : patience:10
2022-01-12 20:28:51,143 - main - INFO - main - 243 : seed:666
2022-01-12 20:28:51,143 - main - INFO - main - 243 : num_workers:1
2022-01-12 20:28:51,143 - main - INFO - train - 62 : n_tags : 3
2022-01-12 20:28:51,143 - main - INFO - train - 66 : Under an epoch, loss will be output every 34 step, and the model will be evaluated every 85 step
2022-01-12 20:28:53,959 - main - INFO - train - 74 : Using device : cuda
2022-01-12 20:28:53,961 - main - INFO - train - 79 : num_train_steps : 1690, warmup_proportion : 0.1, warmup_steps : 169
2022-01-12 20:28:53,961 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:28:56,900 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.0197    0.2812    0.0369       960

   micro avg     0.0197    0.2812    0.0369       960
   macro avg     0.0197    0.2812    0.0369       960
weighted avg     0.0197    0.2812    0.0369       960

2022-01-12 20:28:56,900 - main.utils - INFO - compute_f1 - 130 : F1 : 0.036875170718382956, accuracy : 0.08168347144548312, precision : 0.019731072785735167, recall : 0.28125
2022-01-12 20:28:56,900 - main - INFO - train - 90 : Previous f1 score is -1 and current f1 score is 0.036875170718382956
2022-01-12 20:28:57,253 - main - INFO - train - 112 : Epoch : 0, global_step : 1/1690, loss_value : 40.84240363625919 
2022-01-12 20:28:57,260 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:29:00,062 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.0197    0.2812    0.0369       960

   micro avg     0.0197    0.2812    0.0369       960
   macro avg     0.0197    0.2812    0.0369       960
weighted avg     0.0197    0.2812    0.0369       960

2022-01-12 20:29:00,062 - main.utils - INFO - compute_f1 - 130 : F1 : 0.036875170718382956, accuracy : 0.08168347144548312, precision : 0.019731072785735167, recall : 0.28125
2022-01-12 20:29:00,062 - main - INFO - train - 130 : Left patience is 9
2022-01-12 20:29:09,209 - main - INFO - train - 112 : Epoch : 0, global_step : 35/1690, loss_value : 1239.347245160271 
2022-01-12 20:29:18,157 - main - INFO - train - 112 : Epoch : 0, global_step : 69/1690, loss_value : 564.578416263356 
2022-01-12 20:29:22,654 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:29:25,392 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.0825    0.0979    0.0895       960

   micro avg     0.0825    0.0979    0.0895       960
   macro avg     0.0825    0.0979    0.0895       960
weighted avg     0.0825    0.0979    0.0895       960

2022-01-12 20:29:25,392 - main.utils - INFO - compute_f1 - 130 : F1 : 0.08952380952380952, accuracy : 0.9163979262766869, precision : 0.0824561403508772, recall : 0.09791666666666667
2022-01-12 20:29:25,762 - main - INFO - train - 125 : Previous f1 score is 0.036875170718382956 and current f1 score is 0.08952380952380952, best model has been saved in /home/xhsun/Desktop/tmpFiles/pcode/WNUT-17-crf/pytorch_model.bin/pytorch_model.bin
2022-01-12 20:29:30,306 - main - INFO - train - 112 : Epoch : 0, global_step : 103/1690, loss_value : 332.1217503267176 
2022-01-12 20:29:39,337 - main - INFO - train - 112 : Epoch : 0, global_step : 137/1690, loss_value : 256.67762128044575 
2022-01-12 20:29:48,722 - main - INFO - train - 112 : Epoch : 1, global_step : 171/1690, loss_value : 4.839070937212775 
2022-01-12 20:29:48,732 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:29:51,592 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.2931    0.4552    0.3566       960

   micro avg     0.2931    0.4552    0.3566       960
   macro avg     0.2931    0.4552    0.3566       960
weighted avg     0.2931    0.4552    0.3566       960

2022-01-12 20:29:51,593 - main.utils - INFO - compute_f1 - 130 : F1 : 0.3565891472868217, accuracy : 0.9568518594113565, precision : 0.2930918846411804, recall : 0.4552083333333333
2022-01-12 20:29:52,071 - main - INFO - train - 125 : Previous f1 score is 0.08952380952380952 and current f1 score is 0.3565891472868217, best model has been saved in /home/xhsun/Desktop/tmpFiles/pcode/WNUT-17-crf/pytorch_model.bin/pytorch_model.bin
2022-01-12 20:30:01,275 - main - INFO - train - 112 : Epoch : 1, global_step : 205/1690, loss_value : 178.71023279077866 
2022-01-12 20:30:10,583 - main - INFO - train - 112 : Epoch : 1, global_step : 239/1690, loss_value : 146.77366582085105 
2022-01-12 20:30:15,257 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:30:18,040 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.6647    0.8135    0.7316       960

   micro avg     0.6647    0.8135    0.7316       960
   macro avg     0.6647    0.8135    0.7316       960
weighted avg     0.6647    0.8135    0.7316       960

2022-01-12 20:30:18,040 - main.utils - INFO - compute_f1 - 130 : F1 : 0.731615925058548, accuracy : 0.9766093807404989, precision : 0.6646808510638298, recall : 0.8135416666666667
2022-01-12 20:30:18,523 - main - INFO - train - 125 : Previous f1 score is 0.3565891472868217 and current f1 score is 0.731615925058548, best model has been saved in /home/xhsun/Desktop/tmpFiles/pcode/WNUT-17-crf/pytorch_model.bin/pytorch_model.bin
2022-01-12 20:30:23,212 - main - INFO - train - 112 : Epoch : 1, global_step : 273/1690, loss_value : 98.65287747102626 
2022-01-12 20:30:32,494 - main - INFO - train - 112 : Epoch : 1, global_step : 307/1690, loss_value : 98.51019432965447 
2022-01-12 20:30:41,801 - main - INFO - train - 112 : Epoch : 2, global_step : 341/1690, loss_value : 2.9950882406795727 
2022-01-12 20:30:41,817 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:30:44,639 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.6720    0.7896    0.7261       960

   micro avg     0.6720    0.7896    0.7261       960
   macro avg     0.6720    0.7896    0.7261       960
weighted avg     0.6720    0.7896    0.7261       960

2022-01-12 20:30:44,640 - main.utils - INFO - compute_f1 - 130 : F1 : 0.7260536398467433, accuracy : 0.9777523778421847, precision : 0.6719858156028369, recall : 0.7895833333333333
2022-01-12 20:30:44,640 - main - INFO - train - 130 : Left patience is 8
2022-01-12 20:30:53,955 - main - INFO - train - 112 : Epoch : 2, global_step : 375/1690, loss_value : 80.28806108586929 
2022-01-12 20:31:03,415 - main - INFO - train - 112 : Epoch : 2, global_step : 409/1690, loss_value : 63.71855303820442 
2022-01-12 20:31:08,044 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:31:10,789 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.7645    0.8927    0.8236       960

   micro avg     0.7645    0.8927    0.8236       960
   macro avg     0.7645    0.8927    0.8236       960
weighted avg     0.7645    0.8927    0.8236       960

2022-01-12 20:31:10,789 - main.utils - INFO - compute_f1 - 130 : F1 : 0.8236424795771264, accuracy : 0.9815079397477242, precision : 0.7644959857270295, recall : 0.8927083333333333
2022-01-12 20:31:11,283 - main - INFO - train - 125 : Previous f1 score is 0.731615925058548 and current f1 score is 0.8236424795771264, best model has been saved in /home/xhsun/Desktop/tmpFiles/pcode/WNUT-17-crf/pytorch_model.bin/pytorch_model.bin
2022-01-12 20:31:16,021 - main - INFO - train - 112 : Epoch : 2, global_step : 443/1690, loss_value : 52.46693518582512 
2022-01-12 20:31:25,430 - main - INFO - train - 112 : Epoch : 2, global_step : 477/1690, loss_value : 55.14943526772892 
2022-01-12 20:31:34,817 - main - INFO - train - 112 : Epoch : 3, global_step : 511/1690, loss_value : 1.3290011462043314 
2022-01-12 20:31:34,831 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:31:37,598 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.8171    0.8375    0.8272       960

   micro avg     0.8171    0.8375    0.8272       960
   macro avg     0.8171    0.8375    0.8272       960
weighted avg     0.8171    0.8375    0.8272       960

2022-01-12 20:31:37,598 - main.utils - INFO - compute_f1 - 130 : F1 : 0.8271604938271605, accuracy : 0.9827734008245907, precision : 0.8170731707317073, recall : 0.8375
2022-01-12 20:31:38,078 - main - INFO - train - 125 : Previous f1 score is 0.8236424795771264 and current f1 score is 0.8271604938271605, best model has been saved in /home/xhsun/Desktop/tmpFiles/pcode/WNUT-17-crf/pytorch_model.bin/pytorch_model.bin
2022-01-12 20:31:47,315 - main - INFO - train - 112 : Epoch : 3, global_step : 545/1690, loss_value : 49.484169735628015 
2022-01-12 20:31:56,587 - main - INFO - train - 112 : Epoch : 3, global_step : 579/1690, loss_value : 34.94194990045884 
2022-01-12 20:32:01,230 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:32:03,975 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.7634    0.8906    0.8221       960

   micro avg     0.7634    0.8906    0.8221       960
   macro avg     0.7634    0.8906    0.8221       960
weighted avg     0.7634    0.8906    0.8221       960

2022-01-12 20:32:03,975 - main.utils - INFO - compute_f1 - 130 : F1 : 0.8221153846153846, accuracy : 0.9808139772217006, precision : 0.7633928571428571, recall : 0.890625
2022-01-12 20:32:03,975 - main - INFO - train - 130 : Left patience is 7
2022-01-12 20:32:08,619 - main - INFO - train - 112 : Epoch : 3, global_step : 613/1690, loss_value : 31.398313802831314 
2022-01-12 20:32:17,979 - main - INFO - train - 112 : Epoch : 3, global_step : 647/1690, loss_value : 33.93116591958439 
2022-01-12 20:32:27,434 - main - INFO - train - 112 : Epoch : 4, global_step : 681/1690, loss_value : 0.6717645981732536 
2022-01-12 20:32:27,448 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:32:30,217 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.8134    0.8625    0.8372       960

   micro avg     0.8134    0.8625    0.8372       960
   macro avg     0.8134    0.8625    0.8372       960
weighted avg     0.8134    0.8625    0.8372       960

2022-01-12 20:32:30,218 - main.utils - INFO - compute_f1 - 130 : F1 : 0.8372093023255813, accuracy : 0.9826917581744703, precision : 0.8133595284872298, recall : 0.8625
2022-01-12 20:32:30,720 - main - INFO - train - 125 : Previous f1 score is 0.8271604938271605 and current f1 score is 0.8372093023255813, best model has been saved in /home/xhsun/Desktop/tmpFiles/pcode/WNUT-17-crf/pytorch_model.bin/pytorch_model.bin
2022-01-12 20:32:40,028 - main - INFO - train - 112 : Epoch : 4, global_step : 715/1690, loss_value : 37.19458047081442 
2022-01-12 20:32:49,344 - main - INFO - train - 112 : Epoch : 4, global_step : 749/1690, loss_value : 24.506985159481275 
2022-01-12 20:32:54,041 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:32:56,805 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.8288    0.8521    0.8403       960

   micro avg     0.8288    0.8521    0.8403       960
   macro avg     0.8288    0.8521    0.8403       960
weighted avg     0.8288    0.8521    0.8403       960

2022-01-12 20:32:56,805 - main.utils - INFO - compute_f1 - 130 : F1 : 0.8402670775552131, accuracy : 0.9833040780503736, precision : 0.828774062816616, recall : 0.8520833333333333
2022-01-12 20:32:57,297 - main - INFO - train - 125 : Previous f1 score is 0.8372093023255813 and current f1 score is 0.8402670775552131, best model has been saved in /home/xhsun/Desktop/tmpFiles/pcode/WNUT-17-crf/pytorch_model.bin/pytorch_model.bin
2022-01-12 20:33:01,962 - main - INFO - train - 112 : Epoch : 4, global_step : 783/1690, loss_value : 21.446616397184485 
2022-01-12 20:33:11,319 - main - INFO - train - 112 : Epoch : 4, global_step : 817/1690, loss_value : 27.287141912123737 
2022-01-12 20:33:20,758 - main - INFO - train - 112 : Epoch : 5, global_step : 851/1690, loss_value : 0.2481842041015625 
2022-01-12 20:33:20,775 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:33:23,536 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.8295    0.8719    0.8502       960

   micro avg     0.8295    0.8719    0.8502       960
   macro avg     0.8295    0.8719    0.8502       960
weighted avg     0.8295    0.8719    0.8502       960

2022-01-12 20:33:23,536 - main.utils - INFO - compute_f1 - 130 : F1 : 0.8501777552056882, accuracy : 0.9834265420255541, precision : 0.8295341922695738, recall : 0.871875
2022-01-12 20:33:24,022 - main - INFO - train - 125 : Previous f1 score is 0.8402670775552131 and current f1 score is 0.8501777552056882, best model has been saved in /home/xhsun/Desktop/tmpFiles/pcode/WNUT-17-crf/pytorch_model.bin/pytorch_model.bin
2022-01-12 20:33:33,453 - main - INFO - train - 112 : Epoch : 5, global_step : 885/1690, loss_value : 26.587403970606186 
2022-01-12 20:33:42,806 - main - INFO - train - 112 : Epoch : 5, global_step : 919/1690, loss_value : 15.812253222746008 
2022-01-12 20:33:47,507 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:33:50,268 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.8178    0.8792    0.8474       960

   micro avg     0.8178    0.8792    0.8474       960
   macro avg     0.8178    0.8792    0.8474       960
weighted avg     0.8178    0.8792    0.8474       960

2022-01-12 20:33:50,268 - main.utils - INFO - compute_f1 - 130 : F1 : 0.8473895582329318, accuracy : 0.9827325794995305, precision : 0.8178294573643411, recall : 0.8791666666666667
2022-01-12 20:33:50,268 - main - INFO - train - 130 : Left patience is 6
2022-01-12 20:33:54,957 - main - INFO - train - 112 : Epoch : 5, global_step : 953/1690, loss_value : 17.608406010796042 
2022-01-12 20:34:04,444 - main - INFO - train - 112 : Epoch : 5, global_step : 987/1690, loss_value : 16.14461040496826 
2022-01-12 20:34:13,938 - main - INFO - train - 112 : Epoch : 6, global_step : 1021/1690, loss_value : 0.17758554570815144 
2022-01-12 20:34:13,955 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:34:16,750 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.8332    0.8635    0.8481       960

   micro avg     0.8332    0.8635    0.8481       960
   macro avg     0.8332    0.8635    0.8481       960
weighted avg     0.8332    0.8635    0.8481       960

2022-01-12 20:34:16,750 - main.utils - INFO - compute_f1 - 130 : F1 : 0.8480818414322251, accuracy : 0.9824876515491693, precision : 0.8331658291457287, recall : 0.8635416666666667
2022-01-12 20:34:16,750 - main - INFO - train - 130 : Left patience is 5
2022-01-12 20:34:26,360 - main - INFO - train - 112 : Epoch : 6, global_step : 1055/1690, loss_value : 18.333640827852136 
2022-01-12 20:34:35,899 - main - INFO - train - 112 : Epoch : 6, global_step : 1089/1690, loss_value : 14.22414358924417 
2022-01-12 20:34:40,617 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:34:43,433 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.8162    0.8833    0.8484       960

   micro avg     0.8162    0.8833    0.8484       960
   macro avg     0.8162    0.8833    0.8484       960
weighted avg     0.8162    0.8833    0.8484       960

2022-01-12 20:34:43,433 - main.utils - INFO - compute_f1 - 130 : F1 : 0.8484242121060529, accuracy : 0.9821610809486876, precision : 0.8161693936477382, recall : 0.8833333333333333
2022-01-12 20:34:43,433 - main - INFO - train - 130 : Left patience is 4
2022-01-12 20:34:48,213 - main - INFO - train - 112 : Epoch : 6, global_step : 1123/1690, loss_value : 13.431221288793227 
2022-01-12 20:34:57,757 - main - INFO - train - 112 : Epoch : 6, global_step : 1157/1690, loss_value : 14.715152067296644 
2022-01-12 20:35:07,377 - main - INFO - train - 112 : Epoch : 7, global_step : 1191/1690, loss_value : 0.2088938320384306 
2022-01-12 20:35:07,391 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:35:10,169 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.8327    0.8760    0.8538       960

   micro avg     0.8327    0.8760    0.8538       960
   macro avg     0.8327    0.8760    0.8538       960
weighted avg     0.8327    0.8760    0.8538       960

2022-01-12 20:35:10,169 - main.utils - INFO - compute_f1 - 130 : F1 : 0.8538071065989847, accuracy : 0.9826917581744703, precision : 0.8326732673267326, recall : 0.8760416666666667
2022-01-12 20:35:10,663 - main - INFO - train - 125 : Previous f1 score is 0.8501777552056882 and current f1 score is 0.8538071065989847, best model has been saved in /home/xhsun/Desktop/tmpFiles/pcode/WNUT-17-crf/pytorch_model.bin/pytorch_model.bin
2022-01-12 20:35:20,415 - main - INFO - train - 112 : Epoch : 7, global_step : 1225/1690, loss_value : 14.445081430322984 
2022-01-12 20:35:30,222 - main - INFO - train - 112 : Epoch : 7, global_step : 1259/1690, loss_value : 10.271204050849466 
2022-01-12 20:35:35,223 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:35:38,061 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.8170    0.8833    0.8488       960

   micro avg     0.8170    0.8833    0.8488       960
   macro avg     0.8170    0.8833    0.8488       960
weighted avg     0.8170    0.8833    0.8488       960

2022-01-12 20:35:38,061 - main.utils - INFO - compute_f1 - 130 : F1 : 0.8488488488488489, accuracy : 0.9831816140751929, precision : 0.8169556840077071, recall : 0.8833333333333333
2022-01-12 20:35:38,061 - main - INFO - train - 130 : Left patience is 3
2022-01-12 20:35:42,834 - main - INFO - train - 112 : Epoch : 7, global_step : 1293/1690, loss_value : 9.47795710844152 
2022-01-12 20:35:52,616 - main - INFO - train - 112 : Epoch : 7, global_step : 1327/1690, loss_value : 7.647895252003389 
2022-01-12 20:36:02,446 - main - INFO - train - 112 : Epoch : 8, global_step : 1361/1690, loss_value : 0.10083939047420726 
2022-01-12 20:36:02,468 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:36:05,317 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.8492    0.8740    0.8614       960

   micro avg     0.8492    0.8740    0.8614       960
   macro avg     0.8492    0.8740    0.8614       960
weighted avg     0.8492    0.8740    0.8614       960

2022-01-12 20:36:05,317 - main.utils - INFO - compute_f1 - 130 : F1 : 0.8613963039014374, accuracy : 0.9837531126260358, precision : 0.8491902834008097, recall : 0.8739583333333333
2022-01-12 20:36:05,847 - main - INFO - train - 125 : Previous f1 score is 0.8538071065989847 and current f1 score is 0.8613963039014374, best model has been saved in /home/xhsun/Desktop/tmpFiles/pcode/WNUT-17-crf/pytorch_model.bin/pytorch_model.bin
2022-01-12 20:36:15,568 - main - INFO - train - 112 : Epoch : 8, global_step : 1395/1690, loss_value : 10.463414304396686 
2022-01-12 20:36:25,249 - main - INFO - train - 112 : Epoch : 8, global_step : 1429/1690, loss_value : 9.8929843341603 
2022-01-12 20:36:30,193 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:36:33,034 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.8370    0.8667    0.8516       960

   micro avg     0.8370    0.8667    0.8516       960
   macro avg     0.8370    0.8667    0.8516       960
weighted avg     0.8370    0.8667    0.8516       960

2022-01-12 20:36:33,034 - main.utils - INFO - compute_f1 - 130 : F1 : 0.8515864892528148, accuracy : 0.9830999714250724, precision : 0.8370221327967807, recall : 0.8666666666666667
2022-01-12 20:36:33,034 - main - INFO - train - 130 : Left patience is 2
2022-01-12 20:36:37,768 - main - INFO - train - 112 : Epoch : 8, global_step : 1463/1690, loss_value : 7.610572029562557 
2022-01-12 20:36:47,351 - main - INFO - train - 112 : Epoch : 8, global_step : 1497/1690, loss_value : 6.108259705936208 
2022-01-12 20:36:57,188 - main - INFO - train - 112 : Epoch : 9, global_step : 1531/1690, loss_value : 0.11599422903621898 
2022-01-12 20:36:57,204 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:37:00,098 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.8307    0.8635    0.8468       960

   micro avg     0.8307    0.8635    0.8468       960
   macro avg     0.8307    0.8635    0.8468       960
weighted avg     0.8307    0.8635    0.8468       960

2022-01-12 20:37:00,098 - main.utils - INFO - compute_f1 - 130 : F1 : 0.846782431052094, accuracy : 0.9829366861248316, precision : 0.8306613226452906, recall : 0.8635416666666667
2022-01-12 20:37:00,098 - main - INFO - train - 130 : Left patience is 1
2022-01-12 20:37:09,668 - main - INFO - train - 112 : Epoch : 9, global_step : 1565/1690, loss_value : 9.201403225169463 
2022-01-12 20:37:19,542 - main - INFO - train - 112 : Epoch : 9, global_step : 1599/1690, loss_value : 7.59001490649055 
2022-01-12 20:37:24,548 - main - INFO - predict - 144 : Evaluating the model...
2022-01-12 20:37:27,456 - main.utils - INFO - compute_f1 - 129 :               precision    recall  f1-score   support

     Disease     0.8198    0.8719    0.8450       960

   micro avg     0.8198    0.8719    0.8450       960
   macro avg     0.8198    0.8719    0.8450       960
weighted avg     0.8198    0.8719    0.8450       960

2022-01-12 20:37:27,456 - main.utils - INFO - compute_f1 - 130 : F1 : 0.845027763755679, accuracy : 0.9823243662489285, precision : 0.8197845249755142, recall : 0.871875
2022-01-12 20:37:27,456 - main - INFO - train - 130 : Left patience is 0
2022-01-12 20:37:27,456 - main - INFO - train - 132 : Total patience is 0, run our of patience, early stop!
